<!doctype html>
<html>
  <head>
    <title>Real-Time Stock Data</title>
    <!-- Other head elements -->
  </head>
  <body>
    <h1>Stock Data</h1>

    <!-- Table for multiple stock data -->
    <table id="stocks-table">
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Open</th>
          <th>Low</th>
          <th>High</th>
          <th>Close</th>
          <th>Volume</th>
        </tr>
      </thead>
      <tbody>
        <!-- Stock data rows will be inserted here -->
      </tbody>
    </table>

    <button id="loginBtn">Login</button>
    <button id="registerBtn">Register</button>

    <script>
      document
        .getElementById("loginBtn")
        .addEventListener("click", function () {
          window.location.href = "/login";
        });

      document
        .getElementById("registerBtn")
        .addEventListener("click", function () {
          window.location.href = "/register";
        });

      // Function to update the stock table
      function updateStockTable(stocksData) {
        const tableBody = document
          .getElementById("stocks-table")
          .getElementsByTagName("tbody")[0];
        tableBody.innerHTML = "";

        stocksData.forEach((stock) => {
          const row = tableBody.insertRow();
          row.insertCell(0).innerText = stock.symbol;
          row.insertCell(1).innerText = stock.open;
          row.insertCell(2).innerText = stock.low;
          row.insertCell(3).innerText = stock.high;
          row.insertCell(4).innerText = stock.close;
          row.insertCell(5).innerText = stock.volume;
        });
      }

      // Establish WebSocket connection and listen for messages
      const socket = new WebSocket("ws://" + location.host);

      socket.onopen = function () {
        // Send a message to the server to request multiple stocks data
        socket.send(
          JSON.stringify({
            type: "getMultipleStocks",
            symbols: ["BTC-USD", "DOGE-USD", "AVAX-USD"],
          }),
        );
      };

      socket.onmessage = function (event) {
        const stocksData = JSON.parse(event.data);
        updateStockTable(stocksData);
      };

      socket.onerror = function (error) {
        console.error("WebSocket Error:", error);
      };
    </script>
  </body>
</html>
